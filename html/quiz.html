<!doctype html>
<title>Art Exhibition Game: INSTRUCTIONS</title>

<!-- JQUERY UI STARTS -->
<link type="text/css" href="../lib/jqueryui/css/ui-lightness/jquery-ui-1.8.20.custom.css" rel="Stylesheet" />
<script src="../lib/jqueryui/js/jquery-1.7.2.min.js" charset="utf-8"></script>
<script src="../lib/jqueryui/js/jquery-ui-1.8.20.custom.min.js" charset="utf-8"></script>
<!-- JQUERY UI ENDS -->

<!-- no Escape -->
<!-- <script src="/javascripts/noescape.js" charset="utf-8"></script> -->
<!-- no Escape ends -->

<link rel="stylesheet" type="text/css" href="css/iframe.css">
<link rel="stylesheet" type="text/css" href="css/quiz.css">
<body>

  <div id="container_quiz">
    <h1>Before starting the game answer the following questions:</h1>
    
    <div id="quiz"> 
      <dl>
        <dt><strong>Q.1</strong></dt>
        
        <dd>
        <span id="reviewRange_result" class="quiz_result"></span>
         <form name="reviewRange" id="reviewRange">
			  <p> When reviewing a painting, on which scale can you express your liking? </p>
			  <p>
			    <input type="radio" name="reviewRange" value="0"> From 0 to 10<br>
			    <input type="radio" name="reviewRange" value="1"> From 1 to 5<br>
			    <input type="radio" name="reviewRange" value="2"> From 1 to 9
			  </p>
			   </form>
      </p>
        </dd>
       <dt><strong>Q.2</strong></dt>
       <dd>
       	<span id="reviewSelect_result" class="quiz_result"></span>
       <form name="reviewSelect" id="reviewSelect">
       <p>In the current round you have been the only artist who published in exhibition A. In the next round, will you be a reviewer for exhibition A ?</p>
        <p>
          <input type="radio" name="reviewSelect" value="0"> Yes, in any case <br>
          <input type="radio" name="reviewSelect" value="1"> Yes, if I submit to exhibition A again<br>
          <input type="radio" name="reviewSelect" value="2"> Yes, but only if at least one player submits to exhibition A in the next round<br>
          <input type="radio" name="reviewSelect" value="3"> I don't know, because reviewers are randomly assigned to the exhibitions.
        </p>
      </p>
       </form>
     </dd>
     
     <dt><strong>Q.3</strong></dt>
     <dd>
     <span id="coocom_result" class="quiz_result"></span>
     <form name="coocom" id="coocom">
	      <p> If exhibition A publishes 2 paintings, B 0 paintings, and C 1 painting, what is the payoff for the artists who published ?</p>
	        <p>
	          <input type="radio" name="coocom" value="0"> They all get 3.00 CHF<br>
	          <input type="radio" name="coocom" value="1"> Those who published in A receive 2.15 each, that who published in C receive 4.5 CHF <br>
	          <input type="radio" name="coocom" value="2"> They all get 2 CHF <br>
	          <input type="radio" name="coocom" value="3"> Those who published in A receive 1.5 each, the one who published in C receive 3.00 CHF
	        </p>
	      </p>
	      </form>
	      </dd>
	      </dl>
	       <div id="done_box">
          <button onclick='javascript:checkAnswers();' id="submitQuiz">Click here to check your answers, and start the game. <br>Correct answers <span id="answers_counter">0 / 3</span></button>
        </div>
     </div>
    </div>
    
  </div>
</body>
<script>
var node =  parent.node,
    J = parent.JSUS,
    W = parent.W;


node.window.noEscape(window);

var results = {};

var answers;

node.env('com', function(){
	
	node.env('review_select', function(){
		answers = {
			      coocom: 3,
			      reviewSelect: 2,
			      reviewRange: 0
		};	
	});
	node.env('review_random', function(){
		answers = {
			      coocom: 3,
			      reviewSelect: 3,
			      reviewRange: 0
	  };
  });
	
});
	
node.env('coo', function(){
	  
	  node.env('review_select', function(){
		  answers = {
			      coocom: 2,
			      reviewSelect: 2,
			      reviewRange: 0
			  };
	  });
	  node.env('review_random', function(){
      answers = {
            coocom: 2,
            reviewSelect: 3,
            reviewRange: 0
        }; 
    });
});

node.env('auto', function(){
	node.set('QUIZ', results);
  node.random.emit('DONE', 2000);
});

function checkAnswer(a) {
	if (!a || !answers) return;
	
	var checked = getCheckedValue(a);  
	return checked != answers[a.name];
}

function checkAnswers () {
	var reviewRange = document.getElementById('reviewRange');
	var reviewSelect = document.getElementById('reviewSelect');
	var coocom = document.getElementById('coocom');
	/* console.log(reviewRange);	
	console.log(document.forms['coocom']) */

	var correct, counter = 0;
	J.each(document.forms, function(a){
		if (!results[a.name]) results[a.name] = [];
		correct = checkAnswer(a);
		
		if (correct) {
		  W.highlight(a, 'ERR');
			document.getElementById(a.id + '_result').innerHTML = 'Wrong, try again';
		  results[a.name].push(0);	 
		  }
		  else {  
		    W.highlight(a, 'OK');
        document.getElementById(a.id + '_result').innerHTML = 'Correct!';
				results[a.name].push(1);
				counter++;
		}
	});

  document.getElementById('answers_counter').innerHTML = counter + ' / ' + document.forms.length;
	
	if (counter === document.forms.length) {
		node.set('QUIZ', results);
	 	node.random.emit('DONE', 2000);
	}
	
}


function getCheckedValue(radioObj) {
	  if (!radioObj) return;

	  if (radioObj.length) {
		  for (var i = 0; i < radioObj.length; i++) {
		      if (radioObj[i].checked) {
		        return radioObj[i].value;
		      }
		    }
	  }
	    
	  return radioObj.checked;
	}

	// set the radio button with the given value as being checked
	// do nothing if there are no radio buttons
	// if the given value does not exist, all the radio buttons
	// are reset to unchecked
	function setCheckedValue(radioObj, newValue) {
	  if (!radioObj)
	    return;
	  var radioLength = radioObj.length;
	  if(radioLength == undefined) {
	    radioObj.checked = (radioObj.value == newValue.toString());
	    return;
	  }
	  for(var i = 0; i < radioLength; i++) {
	    radioObj[i].checked = false;
	    if(radioObj[i].value == newValue.toString()) {
	      radioObj[i].checked = true;
	    }
	  }
	}


</script>